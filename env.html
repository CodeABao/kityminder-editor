<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.15/js/adal.min.js"
        integrity="sha384-lIk8T3uMxKqXQVVfFbiw0K/Nq+kt1P3NtGt/pNexiDby2rKU6xnDY8p16gIwKqgI"
        crossorigin="anonymous"></script>
</head>

<div>
    <button id="loginButton">Login</button>
    <button id="logoutButton" style="visibility: hidden;">Logout</button>
    <button id="tokenButton" style="visibility: hidden;">Get Token</button>
</div>

<body>
    <script>

        const loginButton = document.getElementById("loginButton");
        const logoutButton = document.getElementById("logoutButton");
        const tokenButton = document.getElementById("tokenButton");

        var authContext = new AuthenticationContext({
            instance: 'https://login.microsoftonline.com/',
            clientId: "c9b5f67d-5500-4e6e-9529-6c5344abe2e0",
            tenant: "5c7d0b28-bdf8-410c-aa93-4df372b16203",
            cacheLocation: "sessionStorage",
            redirectUri: "https://f019-219-143-130-76.ngrok.io/env.html",
            popUp: true,
            callback: function (errorDesc, token, error, tokenType) {
                console.log('Hello ' + authContext.getCachedUser().profile.upn)

                loginButton.style.visibility = "hidden";
                logoutButton.style.visibility = "visible";
                tokenButton.style.visibility = "visible";
            }
        });

        authContext.log({
            level: 3,
            log: function (message) {
                console.log(message);
            },
            piiLoggingEnabled: false
        });

        loginButton.addEventListener('click', function () {
            authContext.login();
        });

        logoutButton.addEventListener('click', function () {
            authContext.logOut();
        });

        tokenButton.addEventListener('click', () => {
            authContext.acquireTokenPopup(
                "https://lenovobeijing.sharepoint.com",
                null, null,
                function (error, token) {
                    console.log(error, token);
                }
            )
        });

    </script>
</body>

</html>